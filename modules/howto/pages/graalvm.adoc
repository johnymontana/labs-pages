= Using Neo4j With GraalVM
:docs: 
:slug: graalvm
:author: Jennifer Reif
:category: labs
:tags: jvm, polyglot, programming, drivers
:neo4j-versions: 3.5, 4.0, 4.1, 4.2

GraalVM is a runtime that seeks to improve application performance and efficiency, as well as offer a shared runtime for different programming languages to interact with each other.

== What Is GraalVM?

It is a Java Virtual Machine (JVM) and Java Development Kit (JDK) bundled together to decrease the footprint and startup time of an application. GraalVM includes a just-in-time (JIT) compiler, native image, Truffle language implementation framework, and built-in tools. Each of these provisions is explained in a bit more detail below.

* JIT compiler: written in Java and intended to be more modular and flexible than previous compilers. Can run alongside existing compilers, as well as run instead of others.
* https://www.graalvm.org/reference-manual/native-image/[GraalVM native image^]: ahead-of-time (AOT) compiler for JVM-based languages or those implemented in Truffle. Compiles these to executable binaries with the goal of minimal application startup time and application file size.
* https://www.graalvm.org/graalvm-as-a-platform/language-implementation-framework/[Truffle Language Implementation Framework^]: for implementing additional languages on GraalVM. Current implementations include Javascript, Python, Ruby, R, and LLVM. Other language interpreters can be added by using Truffle as the foundation framework.
* https://www.graalvm.org/docs/tools/[Out-of-the-box tools^]: for monitoring, debugging, and development. GraalVM contains language-agnostic tools like backend and Chrome debuggers, dashboards, profiling, code coverage, VSCode extensions, and language protocols.

== Why Use GraalVM With Neo4j?

There are a few different reasons why developers might choose GraalVM over other JVM options.

1. To access Neo4j from outside languages using an official driver (like the Java driver). This allows you to use the Java libraries for connecting to Neo4j from languages like Python, Ruby, R, Javascript, LLVM, as well as other language implementations built with Truffle.

2. To write programs in various languages and bring in non-Java libraries to use with it.
For instance, you could pull in Python's `ratelimit` library or Javascript's `colors` into any other language for a program interacting with Neo4j.

3. To extend Neo4j or the Cypher query language by writing procedures and functions in any language and packaging them as a database plugin for Neo4j.

4. To use Cypher as the query language in various programs (with Cypher Truffle implementation). This would allow you to embed Cypher code in your Python or Javascript program for executing against Neo4j.

== Architecture Overview

image::graalvm_neo4j.png[]

Currently, there are two ways to use GraalVM with Neo4j:

1. Connect to and interact with Neo4j (using the official Java driver) from non-JVM languages - Python, Ruby, R, and Javascript.
2. Execute code in Python, Ruby, R, and Javascript like a Cypher procedure (deployed in a Neo4j plugin).

== How To

=== Libraries / Packages 

* `graalvm/graalvm-ce-builds` - https://github.com/graalvm/graalvm-ce-builds/releases[releases for download^]

Others needed:

1. Connect to Neo4j from non-JVM languages:
* `neo4j-java-driver` - https://neo4j.com/download-center/#drivers[Neo4j Drivers download page^]
* `reactive-streams` - dependency of Java driver above (https://neo4j.com/docs/java-manual/4.2/get-started/#java-driver-get-started-installation[Java driver manual, dependencies^])

2. Execute custom procedures/functions:
* `neo4j` - https://neo4j.com/download-center/#community[download Neo4j community server^]

== Resources

[cols="1,4"]
|===
| icon:github[] Connect to Neo4j from GraalVM | https://github.com/neo4j-labs/neo4j-graalvm
| icon:github[] Extend Neo4j with GraalVM | https://github.com/neo4j-labs/neo4j-graalvm-polyglot
| icon:book[] GraalVM Docs | https://www.graalvm.org/docs/introduction/
| icon:book[] Neo4j docs | https://neo4j.com/docs/
// | icon:book[] Article |
| icon:comments[] Feedback, Questions, & Requests | https://community.neo4j.com/[Neo4j Online Community]
|===